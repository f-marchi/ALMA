
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Introduction &#8212; Lamba Lab</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script async="async" kind="hypothesis" src="https://hypothes.is/embed.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Data Download and Initial Processing" href="../1_MethylData_PreProcessing.html" />
    <link rel="prev" title="Specific Aims" href="Specific_Aims.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/dna1.gif" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Lamba Lab</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    FM’s Electronic Notebook Instructions
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Specific Aims
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Specific_Aims.html">
   Specific Aims
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Manuscripts
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Introduction
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Code
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../1_MethylData_PreProcessing.html">
   Data Download and Initial Processing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../2_MethylData_Processing.html">
   Methyl Array Data Processing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../3_ClinicalData_Processing.html">
   Clinical Data Processing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../4_Dimension_Reduction.html">
   Dimension Reduction with PaCMAP
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../5_Methylome_Visualization.html">
   PaCMAP Visualization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../5.1_Methylome_Bokeh.html">
   PaCMAP Interactive Visualization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../6_Survival_Analysis.html">
   Survival Analysis FM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../6.1_Survival_Analysis_FS.html">
   Survival Analysis FS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../7_Score_Visualization.html">
   Kaplan Meiers, Forest Plots, Patient Characteristics
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/docs/Intro_to_Methylation.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dna-methylation">
   DNA Methylation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#measuring-methylation">
   Measuring Methylation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#array-design">
   Array Design
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#betas-and-m-values">
   Betas and M-Values
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#background-correction-normalization-methods-filtering-etc">
   Background Correction, Normalization Methods, Filtering, etc
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#recommended-reading">
   Recommended Reading
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Introduction</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#dna-methylation">
   DNA Methylation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#measuring-methylation">
   Measuring Methylation
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#array-design">
   Array Design
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#betas-and-m-values">
   Betas and M-Values
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#background-correction-normalization-methods-filtering-etc">
   Background Correction, Normalization Methods, Filtering, etc
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#recommended-reading">
   Recommended Reading
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   References
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="introduction">
<span id="practical-intro1"></span><h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h1>
<p>This section offers a <em>practical</em> introduction to DNA methylation analyses by Illumina’s EPIC and 450k platforms.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This section has been retrieved from python’s <a class="reference external" href="https://life-epigenetics-methylprep.readthedocs-hosted.com/en/latest/docs/introduction/introduction.html">methylprep documentation</a>.</p>
</div>
<section id="dna-methylation">
<h2>DNA Methylation<a class="headerlink" href="#dna-methylation" title="Permalink to this headline">#</a></h2>
<p>In this introduction, we’ll cover what DNA methylation is, where it occurs, how we measure it, and common methods for cleaning/pre-processing data before analysis. At the end of this introduction, we also provide a list of papers, videos, and documentation pages that provide more detail on these topics than we can go into in this quick primer.</p>
<p>DNA methylation occurs when a methyl group (CH3) is transferred to the C5 position of a cytosine base. This is a mechanism for gene regulation. Methylation can be a signal for the cell to recruit inhibiting proteins. The methyl group can also prevent transcription factors from binding to DNA, thus preventing transcription factors from upregulating the affected gene.</p>
<p><img alt="" src="https://raw.githubusercontent.com/FoxoTech/methylprep/master/docs/introduction/DNA_methylation.png" /></p>
<p>So where does methylation commonly occur?<br></p>
<p>The human genome has areas which have a high ratio of CG basepairs. These GC-rich regions are known as CpG islands (<strong>C</strong>ytosine-<strong>p</strong>hosphate-<strong>G</strong>uanine), or CGIs. These regions are generally 500-1500bp with &gt;60% GC-content. CpGs are not to be confused with CG basepair bonds. A CpG island references  the nucleotides in sequence and on one strand of DNA (linked by the phosphodiester bond, hence the p in CpG), <em>not</em> a C linked to a G in a basepair bond. See the example below, which shows a CpG site on the left and a CG basepair bond on the right.</p>
<p><img alt="" src="https://raw.githubusercontent.com/FoxoTech/methylprep/master/docs/introduction/cpg_vs_cg.jpeg" /></p>
<p><br><br></p>
<p>CGIs tend to be in the promoters of genes and usually contain the 5’ end of the transcript. In mammals, it is estimated that 70-80% of cytosines in CGIs are methylated. Unmethylated CpG islands are typically associated with active promoter regions <a class="reference external" href="#jung">[1]</a>.</p>
<p>However, CpG islands are not the only places where methylation occurs. Differential methylation has also been observed in the “shores,” “shelves,” and the “open sea” (these terms are the names of regions that are varying distances from the CpG islands) <a class="reference external" href="#cross">[2]</a>. Shores are up to 2kb from the CpG island and shelves are from 2kb to 4kb from the CpG island. The open sea refers to isolated regions that do not have a specific designation. See figure below.</p>
<p><img alt="" src="https://raw.githubusercontent.com/FoxoTech/methylprep/master/docs/introduction/CpGs.png" /></p>
<p>Methylation also plays an important role in cellular development by silencing some genes and shaping the pathway the cell uses to differentiate itself. The unique and stable methylation patterns of various types of tissue have been documented, but differential methylation has also increasingly been studied in several diseases in recent years [<a class="reference external" href="#fan">[3]</a>, <a class="reference external" href="#reinius">[4]</a>, <a class="reference external" href="#moss">[5]</a>]. DNA methylation occurs over time in normal, healthy cells as a response to environmental stimuli. Another important note is that methylation is reversible, and there is ongoing research into how lifestyle changes can affect methylation patterns in the genome <a class="reference external" href="#hibler">[6]</a>.</p>
</section>
<section id="measuring-methylation">
<h2>Measuring Methylation<a class="headerlink" href="#measuring-methylation" title="Permalink to this headline">#</a></h2>
<p>One of the common methods of measuring DNA methylation is a methylation array, and the most commonly used arrays are manufactured by Illumina. Illumina has released several array types for humans–27k, 450k, EPIC, and EPIC+–as well as a mouse array. (<code class="docutils literal notranslate"><span class="pre">methylsuite</span></code> supports all human and mouse arrays, with options for custom arrays as well). 450k arrays have been discontinued; 90% of the probes that were on 450k arrays are covered by the new EPIC array. The EPIC+ array covers all of the EPIC and 450k probes, in addition to double coverage on some probes of interest for quality control purposes.</p>
<p>These arrays make use of bisulfite sequencing to detect whether specific CpG loci are methylated. With bisulfite sequencing, methylated cytosines are unaffected. Unmethylated cytosines are converted to uracil and then a thymine. So in the new DNA sequence, instead of an unmethylated cytosine, there is a thymine. See below for an example.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>Original DNA sequence:          A C G A T C G C G A
Bisulfite converted sequence:   A C G A T T G T G A
</pre></div>
</div>
<p>We see only the first cytosine remains the same after bisulfite conversion, so we can assume that that particular C is methylated. We can also assume the other two cytosines at the end of the sequence are unmethylated because they were converted to thymines. However, it has been observed that most CpG loci are “in phase” with each other: if one locus is methylated, there is a high probability that the nearby CpG sites are also methylated.</p>
</section>
<section id="array-design">
<h2>Array Design<a class="headerlink" href="#array-design" title="Permalink to this headline">#</a></h2>
<p>Each methylation array is covered in thousands of microwells. Each well houses a silica bead with an oligonucleotide probe targeting a specific DNA sequence. The probe sequence will stop one nucleotide short of the target locus. The target DNA binds to the probe and a fluorescently labelled ddNTP will bind to the end of the sequence, complementing whatever base was present at the target locus (cytosine or thymine). The probes are then excited by a laser and the output frequency is measured.</p>
<p>To confuse things further, there are two types of probes. Both probes are approximately 50bp of target DNA sequence and both types of probe are specific to ONE nucleotide pair’s methylation state. For example, if the probe’s sequence is as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>CTACAAATACGACACCCGCAACCCATATTTCATATATTATCTCATTTAAC
</pre></div>
</div>
<p>We would be evaluating the methylation state of the cytosine in a CpG site immediately following this target sequence.</p>
<p><img alt="" src="https://raw.githubusercontent.com/FoxoTech/methylprep/master/docs/introduction/probe_types.png" /></p>
<p><strong>Infinium I</strong>: Type I probes require two beads for each locus. One bead type (M) is for the methylated state of that locus. If the cytosine is methylated and does <em>not</em> convert after bisulfite conversion, the M bead will bind at that locus (see top right panel of figure above). However, if the cytosine is not methylated and <em>does</em> convert to a thymine, the second bead type (U) will bind to the thymine (see top left panel of figure above). Type I probes are measured by a single channel. These probes are based on the assumption that CpG methylation is correlated in a 50bp span. Underlying CpG sites (other CpGs in the target DNA sequence that are not the final target CpG) are treated as “in phase” with the target locus. In other words, if we revisit our example probe sequence above, that means we would assume that ALL the CpGs in that sequence are in the same methylation state as the one we targeted.</p>
<p><strong>Infinium II</strong>: Type II probes will bind to methylated OR unmethylated bases at the target locus (see bottom panel of figure above). The ddNTP that is incorprated at the end (either an A to match the T for an unmethylated state, or a G to match the C that remains unchanged for a methylated state) will be excited by a laser. Thus, this probe type needs to be measured by two channels (green for methylated, red for unmethylated). Type II probes are more sensitive to underlying CpG sites because the same probe is used to evaluate methylated sequence (where the cytosines are preserved) and unmethylated sequence (where the cytosines are converted to thymines). Thus, type II probes tolerate a maximum of 3 other CpGs in a probe sequence and they will be assigned degenerate “R” bases so that the complimentary target DNA sequence is still able to bind to the probe whether those bases are converted to thymines or not (i.e. regardless of their methylation state). This means that, unlike type I probes, the target locus can be evaluated independently of nearby CpG sites and the “all or nothing” methylation assumption of Type I probes is not applicable.</p>
<p>There is a distinct advantage to the use of type II probes in that they only need one probe per locus, so building an array of type II probes could cover twice as many loci as an array of only type I probes. However, the drawback of type II probes, as covered above, is that they do not function well in regions of high CpG density (such as CpG islands). Also, due to the difference in chemistry, type I probes are considered advantageous for the extremes of methylation states (either completely methylated or completely unmethylated) because the peaks of the beta distribution are spread further apart.</p>
</section>
<section id="betas-and-m-values">
<h2>Betas and M-Values<a class="headerlink" href="#betas-and-m-values" title="Permalink to this headline">#</a></h2>
<p>Beta values and M-Values are two ways to measure methylation. Betas are typically easier to interpet, as they range from 0 to 1 and represent the proportion of how many cells had a methylated base for that probe site. We would expect 0’s and 1’s in a perfect experiment (0 for an unmethylated locus and 1 for a methylated locus), but the reality is that technical noise and other types of variation make it very uncommon to encounter either of those scenarios. More often, beta values lie somewhere between 0.1-0.9, and we see a bimodal distribution with peaks at either end of that range when beta values are plotted on one line.</p>
<p>The beta value is calculated with the following formula:</p>
<img src="https://latex.codecogs.com/svg.latex?\Large\beta = \frac{M}{(M\,+\,U\,+\,\alpha)}" />
<p>Where <img src="https://latex.codecogs.com/svg.latex?M>0" /> and <img src="https://latex.codecogs.com/svg.latex?U>0" />  represent the methylated and unmethylated signals respectively. And  <img src="https://latex.codecogs.com/svg.latex?\alpha" />  is a constant, typically set to 100, that stabilizes the beta value when both the signals are low.
<br><br>Note that <img src="https://latex.codecogs.com/svg.latex?\alpha" /> is sometimes left out of common preprocessing piplines, which results in <img src="https://latex.codecogs.com/svg.latex?\beta" /> being equal to the simple proportion of M/(M+U). <code class="docutils literal notranslate"><span class="pre">minfi</span></code> uses Illumina’s recommended constant of 100, while <code class="docutils literal notranslate"><span class="pre">SeSAMe</span></code> and <code class="docutils literal notranslate"><span class="pre">methylprep</span></code> both set <img src="https://latex.codecogs.com/svg.latex?\alpha" /> to 0 by default (although, in the case of <code class="docutils literal notranslate"><span class="pre">methylprep</span></code>, users may set <code class="docutils literal notranslate"><span class="pre">minfi=True</span></code> when processing raw data, which will mimic <code class="docutils literal notranslate"><span class="pre">minfi</span></code>’s output).
<br><br>
M-values take the ratio of methylated and unmethylated intensities and apply a log transformation. M-values are unbounded, so they can be more difficult to interpret and compare. A value around 0 means that the methylated and unmethylated signals are close to equal. A positive M-value means that the methylated signal is higher, while a negative M-value means that the unmethylated signal is higher.</p>
<img src="https://latex.codecogs.com/svg.latex?\large Mval = \log_2( \frac {(M\,+\,\alpha)}{(U\,+\,\alpha)})" />
<p>Where <img src="https://latex.codecogs.com/svg.latex?M>0" /> and <img src="https://latex.codecogs.com/svg.latex?U>0" />  represent the methylated and unmethylated signals respectively. And  <img src="https://latex.codecogs.com/svg.latex?\alpha" />  is a constant, typically set to 1, that stabilizes the M-value when both the signals are low. Again, <code class="docutils literal notranslate"><span class="pre">methylprep</span></code>’s <img src="https://latex.codecogs.com/svg.latex?\alpha" /> is set to 0 by default, to match <code class="docutils literal notranslate"><span class="pre">SeSAMe</span></code>’s output.</p>
<p>Beta values have been shown to have heteroscedasticity outside of the middle methylation range (0.2-0.8). Additionally, they are bounded, which means they violate the assumptions of the Gaussian distribution that many statistical models apply. The M-value does not have these challenges, but has a much less intuitive biological meaning. Depending on what analyses are being run, either beta or M-values (or both) may be used. In practice, either value works well. <code class="docutils literal notranslate"><span class="pre">methylsuite</span></code> focuses on using beta values because they are more intuitive.</p>
</section>
<section id="background-correction-normalization-methods-filtering-etc">
<h2>Background Correction, Normalization Methods, Filtering, etc<a class="headerlink" href="#background-correction-normalization-methods-filtering-etc" title="Permalink to this headline">#</a></h2>
<p>One of the first processing steps of <code class="docutils literal notranslate"><span class="pre">methylprep</span></code> is to <strong>infer the color channel</strong> for type I probes. Recall that type I probes operate on a single color channel. Each probe’s color channel should be provided as part of the manifest file. Occasionally, these manifest files are inaccurate. <code class="docutils literal notranslate"><span class="pre">methylprep</span></code> will infer and reset the probe’s channel in the manifest based on the actual signals from each channel.</p>
<p>Another issue that arises with multi-channel usage is <strong>dye-bias</strong>. This is a phenomenon where the red and green channels have different signal intensities. They have to be corrected in order for the rest of the processing pipeline to be accurate. <code class="docutils literal notranslate"><span class="pre">methylprep</span></code> uses quantile normalization between red and green channels within a sample to correct this. This is also known as a nonlinear method of dye bias correction (comparable to the one <code class="docutils literal notranslate"><span class="pre">SeSAMe</span></code> uses).</p>
<p><strong>Out-of-band</strong> (OOB) probe data is commonly used as part of the preprocessing pipleline. Recall that type I probes utilize only one color channel but have two probes for one locus. The probe that does not match the actual methylation state of the sample still captures a measure of fluorescence that can be used to help estimate background noise. In other words, if a type I probe is operating on the green channel to capture the methylation state of the locus, we will still have flourescence measures from the red channel (and that fluorescence from the red channel is “OOB” data).</p>
<p>There are many ways to normalize methylation data, but the most widely used method is normal-exponential convolution on out of band probes (<strong>NOOB</strong>). The normal-exponential (normexp) convolution model was developed as part of the RMA algorithm for Affymetrix microarray data (see recommended reading section below for more details on this). The model assumes that the observed intensities are the sum of background noise and true signal components. The background is <em>normally</em> distributed and the signal is <em>exponentially</em> distributed. NOOB is simply using the normexp model on out of band probe data.</p>
<p><strong>Detection P-values</strong> are a measure of how likely it is that a given signal is background fluorescence. There are a few methods of calculating these detection p-values. Illumina’s GenomeStudio uses negative control probes in the array to parametrize a Guassian distribution and recommends p-values&gt;0.05 to be excluded. <code class="docutils literal notranslate"><span class="pre">minfi</span></code>, another popular package for methylation array analysis in R, uses a similar method but with the M and U probes combined into one signal and a background distribution to calculate the Z-score. The background distribution is calculated by combining the color channel(s) of the corresponding probe (type II probes will have both red and green). And they recommend the more stringent exclusion criteria of p-values&gt;0.01 being excluded. <code class="docutils literal notranslate"><span class="pre">SeSAMe</span></code> and <code class="docutils literal notranslate"><span class="pre">methylprep</span></code> implement a different method, known as <strong>pOOBAH</strong> (<strong>P</strong> value <strong>O</strong>ut <strong>O</strong>f <strong>B</strong>and probes for <strong>A</strong>rray <strong>H</strong>ybridization) where they use the OOB signal of all type I probes to calculate an empirical cumulative distribution function. <code class="docutils literal notranslate"><span class="pre">methylprep</span></code> users have the option to save pOOBAH values as an output file after sample processing.</p>
</section>
<section id="recommended-reading">
<h2>Recommended Reading<a class="headerlink" href="#recommended-reading" title="Permalink to this headline">#</a></h2>
<p>While we have done our best to give a concise yet detailed introduction that should cover all you need to know to use <code class="docutils literal notranslate"><span class="pre">methylsuite</span></code>, there is a chance that you are confused (or intrigued) and wish to cover some of these concepts in more detail. Here we provide a few suggested resources:</p>
<ul class="simple">
<li><p>For more about CpG Islands see <a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/7549424/">this article</a></p></li>
<li><p>For more about bisulfite sequencing, see this <a class="reference external" href="https://www.youtube.com/watch?v=OcIazFGQv0g">short video</a></p></li>
<li><p>For more about methylation arrays, see <a class="reference external" href="https://www.molmed.medsci.uu.se/digitalAssets/491/c_491080-l_1-k_epic-data-sheet-2015.pdf">Illumina’s product sheet</a> or <a class="reference external" href="https://www.illumina.com/techniques/microarrays/methylation-arrays.html">Illumina’s webpages on microarrays</a></p></li>
<li><p>For more about type I vs. type II probes, see <a class="reference external" href="https://www.illumina.com/content/dam/illumina-marketing/documents/products/technotes/technote_hm450_data_analysis_optimization.pdf">this piece from Illumina</a></p></li>
<li><p>For more information on beta values and M-values, see <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3012676/">this article</a></p></li>
<li><p>For more information about background correction, here is <a class="reference external" href="https://www.youtube.com/watch?v=_IWhwXnAAls">a helpful video</a>.</p></li>
<li><p><a class="reference external" href="https://academic.oup.com/nar/article/41/7/e90/1070878">This paper</a> is a good resource to learn more about normalization.</p></li>
<li><p>The paper on the RMA algorithm that was used to develop NOOB is located here <a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/17720982/">here</a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">methylsuite</span></code> is partially modeled after R’s <a class="reference external" href="https://bioconductor.org/packages/release/bioc/vignettes/minfi/inst/doc/minfi.html">minfi</a> and <a class="reference external" href="https://bioconductor.org/packages/release/bioc/vignettes/sesame/inst/doc/sesame.html">SeSAMe</a> packages (with expansions and improvements), so their documentation may prove helpful. Also recommended are these two papers that describe <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6237738/">SeSAMe</a> and <a class="reference external" href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC4016708/">minfi</a> in greater detail.</p></li>
<li><p>Dr. Wanding Zhou (SeSAMe’s creator) has published a few other helpful papers, as well. <a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/27924034/">This one</a> includes more information on pOOBAH normalization and <a class="reference external" href="https://pubmed.ncbi.nlm.nih.gov/27924034/">this one</a> is a comprehensive characterization of the EPIC and 450k microarrays.
<br><br></p></li>
</ul>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">#</a></h2>
<ol class="simple">
<li><p><a name="jung"></a> Jung, M., and G. P. Pfeifer. “CpG Islands.” In Brenner’s Encyclopedia of Genetics (Second Edition), edited by Stanley Maloy and Kelly Hughes, 205–7. San Diego: Academic Press, 2013. <a class="reference external" href="https://doi.org/10.1016/B978-0-12-374984-0.00349-1">https://doi.org/10.1016/B978-0-12-374984-0.00349-1</a>.</p></li>
<li><p><a name="cross"></a> Cross, S. H., and A. P. Bird. “CpG Islands and Genes.” Current Opinion in Genetics &amp; Development 5, no. 3 (June 1995): 309–14. <a class="reference external" href="https://doi.org/10.1016/0959-437x(95)80044-1">https://doi.org/10.1016/0959-437x(95)80044-1</a>.</p></li>
<li><p><a name="fan"></a> Fan, Jian, Jun Li, Shicheng Guo, Chengcheng Tao, Haikun Zhang, Wenjing Wang, Ying Zhang, Dake Zhang, Shigang Ding, and Changqing Zeng. “Genome-Wide DNA Methylation Profiles of Low- and High-Grade Adenoma Reveals Potential Biomarkers for Early Detection of Colorectal Carcinoma.” Clinical Epigenetics 12 (April 21, 2020): 56. <a class="reference external" href="https://doi.org/10.1186/s13148-020-00851-3">https://doi.org/10.1186/s13148-020-00851-3</a>.</p></li>
<li><p><a name="reinius"></a> Reinius, Lovisa E., Nathalie Acevedo, Maaike Joerink, Göran Pershagen, Sven-Erik Dahlén, Dario Greco, Cilla Söderhäll, Annika Scheynius, and Juha Kere. “Differential DNA Methylation in Purified Human Blood Cells: Implications for Cell Lineage and Studies on Disease Susceptibility.” PLOS ONE 7, no. 7 (July 25, 2012): e41361. <a class="reference external" href="https://doi.org/10.1371/journal.pone.0041361">https://doi.org/10.1371/journal.pone.0041361</a>.</p></li>
<li><p><a name="moss"></a> Moss, Joshua, Judith Magenheim, Daniel Neiman, Hai Zemmour, Netanel Loyfer, Amit Korach, Yaacov Samet, et al. “Comprehensive Human Cell-Type Methylation Atlas Reveals Origins of Circulating Cell-Free DNA in Health and Disease.” Nature Communications 9, no. 1 (November 29, 2018): 5068. <a class="reference external" href="https://doi.org/10.1038/s41467-018-07466-6">https://doi.org/10.1038/s41467-018-07466-6</a>.</p></li>
<li><p><a name="hibler"></a> Hibler, Elizabeth, Lei Huang, Jorge Andrade, and Bonnie Spring. “Impact of a Diet and Activity Health Promotion Intervention on Regional Patterns of DNA Methylation.” Clinical Epigenetics 11, no. 1 (September 11, 2019): 133. <a class="reference external" href="https://doi.org/10.1186/s13148-019-0707-0">https://doi.org/10.1186/s13148-019-0707-0</a>.</p></li>
</ol>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./docs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="Specific_Aims.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Specific Aims</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../1_MethylData_PreProcessing.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Data Download and Initial Processing</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Lamba Lab @ University of Florida<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>